#include <stdlib.h>
#include <stdio.h>
#include "defs.h"

Real w3[3] = { 0.666666666666667, 0.666666666666667, 0.666666666666667 };
Real L3_1[3] = { 0.666666666666667, 0.166666666666667, 0.166666666666667 };
Real L3_2[3] = { 0.166666666666667, 0.666666666666667, 0.166666666666667 };

Real w6[6] = { 0.2199034873106, 0.2199034873106, 0.2199034873106, 0.4467631793560, 0.4467631793560, 0.4467631793560 };
Real L6_1[6] = { 0.0915762135098, 0.8168475729805, 0.0915762135098, 0.1081030181681, 0.4459484909160, 0.4459484909160 };
Real L6_2[6] = { 0.0915762135098, 0.0915762135098, 0.8168475729805, 0.4459484909160, 0.1081030181681, 0.4459484909160 };

Real w10[10] = { 0.0262712099504, 0.0262716612068, 0.0274163947600, 0.2348383865823, 0.2348412238268, 0.2480251793114, 0.2480304922521, 0.2518604605529, 0.2518660533658, 0.4505789381914 };
Real L10_1[10] = { 0.0000000000000, 1.0000000000000, 0.0000000000000, 0.2673273531185, 0.6728175529461, 0.0649236350054, 0.6716498539042, 0.0654032456800, 0.2693767069140, 0.3386738503896 };
Real L10_2[10] = { 1.0000000000000, 0.0000000000000, 0.0000000000000, 0.6728199218710, 0.2673288599482, 0.6716530111494, 0.0649251690029, 0.2693789366453, 0.0654054874919, 0.3386799893027 };

Real w15[15] = { 0.01025581740920,0.01025581740920,0.01025581740920,0.11160470466470,0.11160470466470,0.11160470466470,0.11160470466470,0.11160470466470,0.11160470466470,0.16797755953350,0.16797755953350,0.16797755953350,0.26522388039460,0.26522388039460,0.26522388039460 };
Real L15_1[15] = { 1.00000000000000,0.00000000000000,0.00000000000000,0.78396566510120,0.17389605073450,0.17389605073450,0.04213828416420,0.78396566510120,0.04213828416420,0.47438808617520,0.47438808617520,0.05122382764970,0.23856153001810,0.52287693996390,0.23856153001810 };
Real L15_2[15] = { 0.00000000000000,0.00000000000000,1.00000000000000,0.04213828416420,0.78396566510120,0.04213828416420,0.17389605073450,0.17389605073450,0.78396566510120,0.47438808617520,0.05122382764970,0.47438808617520,0.52287693996390,0.23856153001810,0.23856153001810 };

Real w21[21] = { 0.0519871420646, 0.0519871420646, 0.0519871420646, 0.0707034101784, 0.0707034101784, 0.0707034101784, 0.0707034101784, 0.0707034101784, 0.0707034101784, 0.0909390760952, 0.0909390760952, 0.0909390760952, 0.0909390760952, 0.0909390760952, 0.0909390760952, 0.1032344051380, 0.1032344051380, 0.1032344051380, 0.1881601469167, 0.1881601469167, 0.1881601469167 };
Real L21_1[21] = { 0.0451890097844, 0.0451890097844, 0.9096219804312, 0.7475124727339, 0.2220631655373, 0.7475124727339, 0.2220631655373, 0.0304243617288, 0.0304243617288, 0.1369912012649, 0.6447187277637, 0.1369912012649, 0.2182900709714, 0.2182900709714, 0.6447187277637, 0.0369603304334, 0.4815198347833, 0.4815198347833, 0.4036039798179, 0.4036039798179, 0.1927920403641 };
Real L21_2[21] = { 0.0451890097844, 0.9096219804312, 0.0451890097844, 0.0304243617288, 0.0304243617288, 0.2220631655373, 0.7475124727339, 0.7475124727339, 0.2220631655373, 0.2182900709714, 0.2182900709714, 0.6447187277637, 0.6447187277637, 0.1369912012649, 0.1369912012649, 0.4815198347833, 0.0369603304334, 0.4815198347833, 0.1927920403641, 0.4036039798179, 0.4036039798179 };

Real w28[28] = { 0.01140824940330,0.01140824940330,0.01326912857200,0.01326912857200,0.01558657733500,0.04082747804280,0.04082747804290,0.05798496651160,0.05798496651160,0.06013852476630,0.06013852476630,0.06252738884330,0.06252738884330,0.06396843215040,0.06396843215040,0.06613258721610,0.06685032368200,0.06685032368210,0.06869043059770,0.06869043059770,0.10027175438590,0.11431367840990,0.11431367840990,0.12236481467520,0.12236481467520,0.13944223341780,0.13944223341780,0.17443778291820 };
Real L28_1[28] = { 0.00000000000000,0.94517044501730,0.92890024057190,0.06855057972240,0.02432683556150,0.12796628353350,0.02778387494880,0.02870834283600,0.74983475886560,0.72280079097070,0.24976020623860,0.08655629928390,0.83255138569980,0.30616191576720,0.03035266174910,0.48686105950470,0.66579042930170,0.17654561542210,0.02931210073600,0.52956574886670,0.14446738243910,0.32997401114110,0.53618157290520,0.55115075168620,0.14377908619230,0.33480665873270,0.15296194371610,0.34301834981470 };
Real L28_2[28] = { 0.94517044501740,0.00000000000000,0.06855057972240,0.92890024057170,0.02432683556160,0.02778387494880,0.12796628353370,0.74983475886570,0.02870834283600,0.24976020623850,0.72280079097070,0.83255138569970,0.08655629928390,0.03035266174910,0.30616191576750,0.48686105950470,0.17654561542190,0.66579042930160,0.52956574886690,0.02931210073600,0.14446738243910,0.53618157290500,0.32997401114090,0.14377908619230,0.55115075168620,0.15296194371610,0.33480665873270,0.34301834981470 };

Real w36[36] = { 0.01662409987570,0.01668116997780,0.01668305690670,0.01756808700830,0.01844746618450,0.01979424101880,0.02035403958550,0.02068528639400,0.02082713660860,0.03178197782790,0.03204720352410,0.03206076811460,0.04307659591830,0.04384734153390,0.04392096727330,0.04799519236910,0.04838062607330,0.04848674233750,0.05569644880240,0.05610263643560,0.05651901236930,0.06892898906700,0.07172133360890,0.07274539209760,0.07888073367370,0.08101143455120,0.08257252990550,0.08420445673300,0.08435855333050,0.08519698684880,0.09028453280520,0.09142831434850,0.09162790654090,0.10255733748960,0.10331596614130,0.10358543671930 };
Real L36_1[36] = { 0.02429353515900,0.02651934277220,0.94921260235510,0.00337757637490,0.47576722981010,0.51907831934710,0.86168397453210,0.12492097599260,0.01385654538610,0.02118870642220,0.84322967872190,0.13542317978650,0.30888535106790,0.66850575951690,0.02265450125570,0.28085154087720,0.69224467490510,0.02686174471190,0.11417784854700,0.79748079220610,0.08928072938940,0.10524878924550,0.66630222807400,0.23078037375470,0.17050591575400,0.50865939730430,0.31418238622810,0.46174608178640,0.06930874960810,0.46519552592680,0.25786258578930,0.61126277667790,0.13051821359340,0.42814379918280,0.33569957837300,0.23054242988360 };
Real L36_2[36] = { 0.94930592938460,0.02426951306400,0.02650679664370,0.47673164123630,0.51989218291020,0.00559127062020,0.01339960486180,0.86130543213340,0.12477337173580,0.84384383512230,0.13545636458300,0.02134828206560,0.02219196630140,0.30890128793890,0.66917099433210,0.69247181551060,0.02687233450260,0.28100939732220,0.79735814135860,0.08798065087910,0.11450205611280,0.66869041199220,0.22750516318320,0.10545725612210,0.51740643986580,0.31705238552090,0.18107063616590,0.46785945398040,0.46228560420850,0.07243578056690,0.61313950391770,0.13003608346090,0.25817138288840,0.23620059698170,0.43110263085880,0.34560139493760 };

Real w45[45] = {0.00106167119900,0.00106167119900,0.00106167119900,0.01314602361010,0.01314602361010,0.01314602361010,0.01314602361010,0.01314602361010,0.01314602361010,0.02428819269490,0.02428819269490,0.02428819269490,0.02428819269490,0.02428819269490,0.02428819269490,0.03167998663320,0.03167998663320,0.03167998663320,0.03167998663320,0.03167998663320,0.03167998663320,0.03493179470360,0.03493179470360,0.03493179470360,0.03836645339450,0.03836645339450,0.03836645339450,0.05783694912100,0.05783694912100,0.05783694912100,0.05783694912100,0.05783694912100,0.05783694912100,0.07258216873940,0.07258216873940,0.07258216873940,0.07258216873940,0.07258216873940,0.07258216873940,0.08978565241070,0.08978565241070,0.08978565241070,0.10345445336170,0.10345445336170,0.10345445336170};
Real L45_1[45] = {0.00000000000000,1.00000000000000,0.00000000000000,0.05733308730260,0.05733308730260,0.92752868571600,0.01513822698140,0.92752868571600,0.01513822698140,0.81596250407110,0.81596250407110,0.16597199695650,0.01806549897240,0.16597199695650,0.01806549897240,0.31654755563780,0.66476375448490,0.01868868987730,0.01868868987730,0.31654755563780,0.66476375448490,0.01926621924920,0.49036689037540,0.49036689037540,0.08751346695810,0.08751346695810,0.82497306608370,0.09355260362190,0.09355260362190,0.20798654231670,0.69846085406130,0.69846085406130,0.20798654231670,0.09748929834670,0.36450184213830,0.53800885951490,0.53800885951490,0.36450184213830,0.09748929834670,0.22171458948730,0.55657082102530,0.22171458948730,0.38604716692960,0.22790566614080,0.38604716692960};
Real L45_2[45] = {1.00000000000000,0.00000000000000,0.00000000000000,0.01513822698140,0.92752868571600,0.05733308730260,0.05733308730260,0.01513822698140,0.92752868571600,0.16597199695650,0.01806549897240,0.81596250407110,0.81596250407110,0.01806549897240,0.16597199695650,0.01868868987730,0.01868868987730,0.66476375448490,0.31654755563780,0.66476375448490,0.31654755563780,0.49036689037540,0.01926621924920,0.49036689037540,0.82497306608370,0.08751346695810,0.08751346695810,0.20798654231670,0.69846085406130,0.09355260362190,0.09355260362190,0.20798654231670,0.69846085406130,0.53800885951490,0.09748929834670,0.09748929834670,0.36450184213830,0.53800885951490,0.36450184213830,0.55657082102530,0.22171458948730,0.22171458948730,0.22790566614080,0.38604716692960,0.38604716692960};

Real w55[55] = {0.00062025998510,0.00063151747120,0.00070866015590,0.00551637161680,0.00626924076560,0.00785314088260,0.00945514838640,0.00978245112710,0.00998616434890,0.01375538188160,0.01409791780400,0.01496468643370,0.01560975036120,0.01576836933480,0.01757945463830,0.02041138402700,0.02095628786160,0.02107134129980,0.02176467602020,0.02222884086990,0.02241866936820,0.02301226169930,0.02368139025000,0.02574646433680,0.02579568016080,0.02580723276100,0.02603432320590,0.02657681416090,0.02657847618310,0.02675323292380,0.03757878066410,0.03830658941950,0.03848496950250,0.03896198258520,0.03946041115470,0.04123647780980,0.05128724384830,0.05164056419350,0.05182300422690,0.05285279881810,0.05385055730270,0.05418953293190,0.05847371464440,0.05928631683630,0.05943582767490,0.06318002558630,0.06329268451530,0.06407073617720,0.08120405959180,0.08144375135300,0.08146792012410,0.08150505480840,0.08151646649390,0.08169310596230,0.09232183345310};
Real L55_1[55] = {1.00000000000000,0.00000000000000,0.00000000000000,0.93988635835770,0.05438066830580,0.00939400491640,0.01643450863620,0.94694872698620,0.04266040057680,0.01222694954390,0.86736965210470,0.84567440213890,0.13957596321030,0.13178217432310,0.01579551263000,0.73654628844360,0.01396884303300,0.25478951860390,0.73163865225550,0.01572537289510,0.26623028436470,0.86735040652140,0.07414936669570,0.01592859483600,0.01560610280680,0.59100948174840,0.40347714968890,0.56947456285260,0.06784937006500,0.42659685902720,0.06709825078900,0.75283102314800,0.77537277835570,0.16890731577870,0.16873358329190,0.08212447084360,0.62887053633450,0.08114130152660,0.29691120650800,0.07675423141710,0.62230223338450,0.31037862880510,0.08192182151870,0.47170226650130,0.45466034152500,0.17010913392370,0.64060043294870,0.19122675837170,0.18853157670700,0.47729299576910,0.31269746217600,0.49612259459460,0.19288053128670,0.33600414538160,0.33372805508480};
Real L55_2[55] = {0.00000000000000,1.00000000000000,0.00000000000000,0.00498487446340,0.93864056186170,0.05264244626970,0.94690355173510,0.03633736771670,0.01512245417990,0.86937735106640,0.12049172857740,0.01577639678700,0.84481208703750,0.01350096055840,0.14552749385360,0.01556975409080,0.73798368944500,0.72976156897710,0.25430766833150,0.26962397957910,0.01447839563080,0.05916794104000,0.86347825750610,0.41912389552380,0.58092229211460,0.01592514526510,0.58067003681040,0.41494951463020,0.07612186785910,0.01575096923120,0.77418983124210,0.08191194956390,0.15771284572920,0.75039430997420,0.07083115072680,0.17629966267710,0.08077449533170,0.30543735897760,0.62274859888710,0.62472471495460,0.30114858211660,0.07790983650790,0.46036330383510,0.08215540067970,0.46375650338900,0.64222778081880,0.18982935372560,0.17399556853430,0.47989140704060,0.33483565981190,0.49579721972590,0.19275536689040,0.31610158072610,0.18948928012900,0.33435710218110};

Real w66[66] = {0.00251657569860,0.00252734520070,0.00332692953330,0.00815034921250,0.00861355257420,0.00877867461790,0.00970995855620,0.01024662119150,0.01083976883410,0.01293853901760,0.01363398235830,0.01384773281470,0.01394215401050,0.01441213999680,0.01537034555340,0.01624898022530,0.01697183042800,0.01700885324210,0.01709535206750,0.01738888545590,0.01745439624390,0.01784067572870,0.01784468638790,0.01790463375520,0.01812597562010,0.01847848388820,0.01857935643710,0.02032171517770,0.02137716618090,0.02319168540980,0.02744267108590,0.02903019223400,0.02945227385050,0.02994362516290,0.03070269481190,0.03252633658630,0.03278842085060,0.03312346751920,0.03461675268750,0.03470813739760,0.03473720494040,0.03485287624540,0.03486015611860,0.03554715699750,0.03601829963830,0.03629262858430,0.03818977020830,0.03922528001180,0.04827101258880,0.04899121215660,0.04972208338720,0.05070657369860,0.05097719940430,0.05213600636670,0.05234608749250,0.05244406835520,0.05274596448230,0.05294490637280,0.05423955945010,0.05434702034190,0.05471005486390,0.05572883459130,0.05777342642330,0.05853937816230,0.06090392506800,0.06372739644490};
Real L66_1[66] = {0.01167310596680,0.98100308583880,0.01069663170920,0.93824769835510,0.01266275184170,0.05981094099840,0.01373632979270,0.92295279594050,0.06331073549930,0.01172651003350,0.15547205873230,0.83432938889820,0.85016380319570,0.01288163505220,0.15108016089590,0.01019178792170,0.28133723993030,0.71243746285010,0.27630252508630,0.01096583685610,0.42891105178840,0.42154205551150,0.57112585904440,0.58268682705110,0.01305678067130,0.01307604009640,0.72634370624070,0.06872300686370,0.86523021015290,0.06485990710370,0.14834949433620,0.06243598983960,0.78713690117350,0.05191049216100,0.15431299274440,0.26178427456030,0.76672578728130,0.25821036766270,0.06790659251470,0.52935782748040,0.06660361504840,0.05856754618990,0.06445353604110,0.67481384291510,0.39146023103690,0.64877014923070,0.39464982204080,0.53901371519330,0.16278950827850,0.68124363226410,0.15428328780200,0.25227277504450,0.25479815324070,0.14855805491940,0.29302396064360,0.28089912723100,0.48209895929710,0.56418782454440,0.13076996443440,0.14796922219480,0.56386842229460,0.43611574287900,0.36032639352850,0.42241883346740,0.37190018330520,0.24136450069280};
Real L66_2[66] = {0.98125659512890,0.00714625048630,0.01151539333760,0.04955705913410,0.93701236206150,0.01213645789220,0.06127836255970,0.01411282706020,0.92201972917270,0.15005204752290,0.83251471215890,0.01252281587590,0.13719975087360,0.84776270634790,0.01365269240390,0.57704386183450,0.70668537596230,0.01245697809900,0.01217413113860,0.41943067124660,0.55996160674690,0.01164759947850,0.01182183139890,0.40578895811770,0.27250237508680,0.72247125232330,0.26029840192510,0.06314172772100,0.07206118373380,0.85904335439100,0.78887883522400,0.14939354993540,0.06563820427570,0.52556356956050,0.07163839269170,0.06214794852880,0.16582115548310,0.68001197661390,0.75715154377820,0.41215038411070,0.26125130878860,0.39022361145350,0.63736265597610,0.06375833420610,0.55032380905630,0.28367283602630,0.06051755225540,0.06119901769360,0.68613221410350,0.15679683458990,0.16675126240200,0.25048039333950,0.49940906490430,0.57560230960870,0.56568973541620,0.14379215742480,0.25185575358650,0.14629667431530,0.44895775861170,0.30011743868290,0.28137720892980,0.42520534464200,0.25991900048890,0.14532384433030,0.37801227035670,0.38475632849400};

Real w78[78] = {0.00217445453990,0.00289871352650,0.00308460293370,0.00344016331040,0.00418984720120,0.00447380514980,0.00470544208140,0.00488679357500,0.00519276433690,0.00740730589810,0.00797554103010,0.00835505229100,0.00961666608640,0.00963182578500,0.00985774607580,0.01026578803010,0.01031881031110,0.01062910016300,0.01068813068950,0.01069690210100,0.01090264617140,0.01098997835750,0.01134230552290,0.01205356429300,0.01396191938210,0.01411479915360,0.01419303470460,0.01442126762680,0.01447043468550,0.01449497698720,0.01453867756940,0.01459641909260,0.01473145784660,0.01674639633040,0.01689555004580,0.01694226628840,0.01730701720950,0.01745245464930,0.01772172221590,0.02828240240230,0.02849967124880,0.02850056465390,0.03006472234780,0.03020312770820,0.03039871360770,0.03056687960740,0.03060674130020,0.03093300682010,0.03097738208350,0.03131462505450,0.03135734933920,0.03143204692870,0.03151821438940,0.03242481379850,0.03475121523860,0.03503934549270,0.03507174203100,0.03521292153340,0.03526155049810,0.03664032203430,0.03677331076700,0.03716756629370,0.03733715716060,0.04039733465880,0.04135800406380,0.04219577918700,0.04954510040370,0.05004192611410,0.05057945871150,0.05200372101880,0.05215335678860,0.05248991523580,0.05991597625160,0.05996099974260,0.05999152721290,0.06341331834490,0.06353118611080,0.06372066056720};
Real L78_1[78] = {0.00894113371120,0.97926226298070,0.01054753821120,0.00237770619470,0.06304251157950,0.93084224967300,0.06290765554900,0.93159622463810,0.00619516894150,0.02871258192370,0.92938444783050,0.03754575666210,0.00868957390640,0.15475970539650,0.83310252941850,0.83742310735260,0.15593625052340,0.00985996420950,0.40558737332890,0.59647278986180,0.00807478004160,0.00750739777210,0.39367645192370,0.58465307262120,0.48708041121200,0.26835128117850,0.72239562887480,0.27168267423570,0.01125808420460,0.01150347343700,0.71405259005640,0.49028710531120,0.02014234252090,0.03611074648590,0.86079988198510,0.10058915260010,0.09187407170580,0.86048882961910,0.04398421786730,0.20110176067350,0.74499937262630,0.05321866413100,0.74539846474010,0.19572899328760,0.10925320579880,0.05676257020010,0.04838379334750,0.10806128097600,0.61856059009910,0.77212960134970,0.61157348011330,0.33813261033760,0.11730841282540,0.26745512605960,0.65421001600260,0.05382974811580,0.18488403241170,0.33762671047440,0.60671020344990,0.46126140854960,0.15254653656710,0.07005825435430,0.47042013790320,0.12164616937460,0.63714040527020,0.23799045151190,0.14839298571770,0.35980695715500,0.49414410550950,0.14406306879810,0.50197644400040,0.35554238342980,0.24434395407710,0.24370649893420,0.51222008073210,0.25260383151780,0.37598956528510,0.37290779871440};
Real L78_2[78] = {0.00869832937020,0.01026441337440,0.97855142025150,0.06365510986040,0.00415063475090,0.00480534822630,0.93167900694810,0.06262648818010,0.92935870585640,0.03102021229970,0.03421529682190,0.92578688846690,0.15849712515100,0.83636066576880,0.00892572448240,0.15291673040780,0.00949662400580,0.83422114935960,0.00743893020080,0.39563308093110,0.40313194259030,0.58516095946810,0.59748965928990,0.00872504649680,0.02021292299120,0.72023400886680,0.26623993664560,0.01128826988080,0.71696959633250,0.27400671101660,0.01135115604970,0.49364918414680,0.48325734596010,0.09356795015820,0.03973790670750,0.85863434193520,0.03955130019730,0.09662240570790,0.85618863491070,0.74491158356260,0.05368656381660,0.19637542759350,0.19820658055500,0.05557138331560,0.61000361824130,0.74091218949590,0.60751356609780,0.11220815104370,0.26987537030350,0.11141173953330,0.33893676779310,0.04946939387870,0.76964513097950,0.11157188081540,0.19065483147000,0.33586168268490,0.15518315238510,0.60814025962940,0.05426327955980,0.06881766707220,0.65102408457490,0.46619043927420,0.46348264553530,0.23814948755160,0.12383993845130,0.63702164523260,0.48941885777800,0.14528808662530,0.36102163838180,0.35135083418870,0.14354916632930,0.50164915995020,0.24060521291040,0.51090172770550,0.24527379735430,0.37003195550940,0.25054066116310,0.37537502775490};

Real w91[91] = {0.00067044364390,0.00067044364390,0.00067044364390,0.00454726080740,0.00454726080740,0.00454726080740,0.00454726080740,0.00454726080740,0.00454726080740,0.00520775853200,0.00520775853200,0.00520775853200,0.00520775853200,0.00520775853200,0.00520775853200,0.00654354328870,0.00654354328870,0.00654354328870,0.00927378415330,0.00927378415330,0.00927378415330,0.00927378415330,0.00927378415330,0.00927378415330,0.00959377826230,0.00959377826230,0.00959377826230,0.00959377826230,0.00959377826230,0.00959377826230,0.01142478091670,0.01142478091670,0.01142478091670,0.01142478091670,0.01142478091670,0.01142478091670,0.01172169641740,0.01172169641740,0.01172169641740,0.01172169641740,0.01172169641740,0.01172169641740,0.01881971552320,0.01881971552320,0.01881971552320,0.01881971552320,0.01881971552320,0.01881971552320,0.02352609802710,0.02352609802710,0.02352609802710,0.02355714661510,0.02355714661510,0.02355714661510,0.02682462074300,0.02682462074300,0.02682462074300,0.02682462074300,0.02682462074300,0.02682462074300,0.03142897767790,0.03142897767790,0.03142897767790,0.03142897767790,0.03142897767790,0.03142897767790,0.03371961921590,0.03371961921590,0.03371961921590,0.03371961921590,0.03371961921590,0.03371961921590,0.04277452942130,0.04277452942130,0.04277452942130,0.04277452942130,0.04277452942130,0.04277452942130,0.04411389327370,0.04411389327370,0.04411389327370,0.04614695946840,0.04614695946840,0.04614695946840,0.04614695946840,0.04614695946840,0.04614695946840,0.04691524686240,0.04691524686240,0.04691524686240,0.05511999803470};
Real L91_1[91] = {0.00355243919220,0.00355243919220,0.99289512161560,0.95535482737300,0.03585527971770,0.95535482737300,0.00878989290930,0.00878989290930,0.03585527971770,0.88652648790470,0.88652648790470,0.00524053759350,0.00524053759350,0.10823297450170,0.10823297450170,0.04663974321500,0.04663974321500,0.90672051357000,0.20757204569460,0.20757204569460,0.78415203017700,0.00827592412840,0.00827592412840,0.78415203017700,0.08581194897250,0.88270435625740,0.03148369477010,0.08581194897250,0.88270435625740,0.03148369477010,0.66887782338260,0.00951507606250,0.00951507606250,0.66887782338260,0.32160710055500,0.32160710055500,0.43799995431130,0.00998597856810,0.43799995431130,0.00998597856810,0.55201406712060,0.55201406712060,0.79749310721480,0.04050939941190,0.04050939941190,0.16199749337340,0.79749310721480,0.16199749337340,0.38642155519550,0.38642155519550,0.22715688960900,0.80901293793290,0.09549353103360,0.09549353103360,0.27454252387180,0.04798404807210,0.67747342805610,0.67747342805610,0.27454252387180,0.04798404807210,0.40534724466670,0.05166779309890,0.40534724466670,0.54298496223440,0.05166779309890,0.54298496223440,0.18777386155390,0.70541131168720,0.70541131168720,0.10681482675880,0.18777386155390,0.10681482675880,0.11950597120090,0.11950597120090,0.57478172973480,0.57478172973480,0.30571229906430,0.30571229906430,0.59812457433630,0.20093771283190,0.20093771283190,0.21607752000050,0.31213602566730,0.21607752000050,0.31213602566730,0.47178645433210,0.47178645433210,0.43765799038490,0.43765799038490,0.12468401923030,0.33333333333330};
Real L91_2[91] = {0.00355243919220,0.99289512161560,0.00355243919220,0.00878989290930,0.00878989290930,0.03585527971770,0.03585527971770,0.95535482737300,0.95535482737300,0.10823297450170,0.00524053759350,0.10823297450170,0.88652648790470,0.88652648790470,0.00524053759350,0.90672051357000,0.04663974321500,0.04663974321500,0.00827592412840,0.78415203017700,0.20757204569460,0.78415203017700,0.20757204569460,0.00827592412840,0.03148369477010,0.03148369477010,0.08581194897250,0.88270435625740,0.08581194897250,0.88270435625740,0.00951507606250,0.32160710055500,0.66887782338260,0.32160710055500,0.66887782338260,0.00951507606250,0.00998597856810,0.55201406712060,0.55201406712060,0.43799995431130,0.43799995431130,0.00998597856810,0.04050939941190,0.16199749337340,0.79749310721480,0.79749310721480,0.16199749337340,0.04050939941190,0.38642155519550,0.22715688960900,0.38642155519550,0.09549353103360,0.80901293793290,0.09549353103360,0.04798404807210,0.67747342805610,0.04798404807210,0.27454252387180,0.67747342805610,0.27454252387180,0.54298496223440,0.40534724466670,0.05166779309890,0.05166779309890,0.54298496223440,0.40534724466670,0.10681482675880,0.18777386155390,0.10681482675880,0.70541131168720,0.70541131168720,0.18777386155390,0.30571229906430,0.57478172973480,0.11950597120090,0.30571229906430,0.57478172973480,0.11950597120090,0.20093771283190,0.59812457433630,0.20093771283190,0.31213602566730,0.21607752000050,0.47178645433210,0.47178645433210,0.31213602566730,0.21607752000050,0.43765799038490,0.12468401923030,0.43765799038490,0.33333333333330};

Real w105[105] = {0.00064382982610,0.00064384130760,0.00101347357100,0.00101347525760,0.00196799299350,0.00334673137840,0.00334673392080,0.00428733233750,0.00428734598850,0.00430038013720,0.00430038490980,0.00569346292050,0.00569346401340,0.00616438680150,0.00616447564180,0.00620145135910,0.00620145319520,0.00696363302940,0.00696363318420,0.00750662577200,0.00750662645650,0.00790747683390,0.00790747724850,0.00803533446230,0.00879634410740,0.00879634481120,0.00913041957160,0.00913042136110,0.00928217487510,0.00928218156620,0.00944998061780,0.00946274684840,0.00946274852940,0.00955557722850,0.00955557928430,0.00961388424880,0.00961388468260,0.00999915242120,0.00999915518500,0.01003013192770,0.01003013466360,0.01249366761850,0.01249367261250,0.01401973091370,0.01433362168960,0.01433362721250,0.01536041427400,0.01536041834250,0.01845238256140,0.01845238631460,0.01958339835730,0.01958340199940,0.01976327513420,0.01976327666770,0.01988063910190,0.01988064857760,0.02071818384840,0.02071819348930,0.02089430714400,0.02089432519560,0.02148645738850,0.02148645860070,0.02222181330360,0.02222181602030,0.02233453054550,0.02233453787390,0.02247589249460,0.02247589804400,0.02297013958450,0.02297033944380,0.02327983761020,0.02327984275060,0.02694831996470,0.02694833071070,0.02804387580100,0.02804387646070,0.02875262701720,0.02875263872710,0.02989808290630,0.02989809227590,0.03090043585160,0.03090043859560,0.03140310170880,0.03140310739550,0.03191915530240,0.03191916683780,0.03214299240620,0.03303956013880,0.03303956318290,0.03561690955890,0.03561692760540,0.03657411899980,0.03657415152040,0.03659776469900,0.03659780538890,0.03699456801140,0.03699457750590,0.03740536237870,0.03755502583170,0.03755503125300,0.03888876934860,0.03888877083420,0.03927056435480,0.03927058025170,0.03987668798310};
Real L105_1[105] = {0.00878093038360,0.99036753142200,0.00270292764500,0.03359092145240,0.00916750686060,0.96755681825580,0.00847372006880,0.00787819487920,0.06767854777000,0.94702669550470,0.04429747556800,0.91442432148820,0.00817354244590,0.24974522927410,0.38332326460550,0.88768503535570,0.10353292282970,0.00772559236180,0.14031924251070,0.81045910096520,0.18096430037170,0.83307679486840,0.00830109071260,0.03484077061470,0.27402876796080,0.71739822247780,0.23949768582340,0.00818591858450,0.00688361520750,0.48437414856990,0.49607677727410,0.61129367762450,0.38043239803450,0.73038907135240,0.00839871686390,0.61285256756120,0.00754759610370,0.00795253165130,0.35597748704600,0.91102369779660,0.04372336051660,0.03884800618350,0.09670321179360,0.08732269113120,0.04214452020840,0.84856179749610,0.84779213338640,0.10674358893980,0.18339665219910,0.04163405411670,0.76116322515600,0.19415992541440,0.75793787471730,0.04398265123950,0.03697605359180,0.53631871343420,0.10012569489210,0.79122666935240,0.03798667141770,0.41574140289650,0.65071064914630,0.04201411334380,0.04255484442540,0.29206271072400,0.53897295381800,0.41930318284890,0.65494720097000,0.30073527909170,0.37524007715850,0.34539802827860,0.09945321687610,0.15983093595850,0.17973266616670,0.71245844619430,0.10660656786360,0.70017019040960,0.09933036298010,0.60656480525210,0.10232235427040,0.25333823249380,0.61662267152170,0.27695006931090,0.09041845718730,0.49815227672480,0.09282318601680,0.37384186992290,0.25216788404070,0.50875002187080,0.39055791167310,0.17061414690960,0.52667377613120,0.34875815276290,0.25880535960170,0.16966145580530,0.30135218068750,0.25802024097590,0.45847408601980,0.18488986834980,0.61307403384650,0.19216117509940,0.41805411605990,0.16506126420360,0.51592057396250,0.29827189357500,0.40988946023400};
Real L105_2[105] = {0.99036764367720,0.00878092162320,0.03359144044390,0.00270289467100,0.00916763530510,0.00847371766560,0.96755694353450,0.06767849438620,0.00787816592910,0.04429745411870,0.94702666764870,0.00817354551320,0.91442442340310,0.38332324347200,0.24974512680050,0.10353288094460,0.88768499318400,0.14031909919740,0.00772559346240,0.18096425239260,0.81045905153340,0.00830109396770,0.83307685453920,0.03484069694820,0.71739818479480,0.27402873043860,0.00818591822620,0.23949755666770,0.48437408926870,0.00688362329490,0.49607675295070,0.38043236912390,0.61129364665330,0.00839871797010,0.73038908954070,0.00754759796950,0.61285254845820,0.35597738267210,0.00795253585020,0.04372336653450,0.91102368074460,0.09670309082820,0.03884799423860,0.08732266203910,0.84856177891080,0.04214454209150,0.10674359424720,0.84779213281460,0.04163405216080,0.18339651969300,0.19415992028520,0.76116321539380,0.04398266085860,0.75793782423080,0.53631860764360,0.03697607809350,0.79122670935450,0.10012575546730,0.41574131285580,0.03798670615350,0.04201412267130,0.65071056450840,0.29206260234840,0.04255485467530,0.41930314690050,0.53897290936100,0.30073526361620,0.65494718127310,0.34539801307520,0.37524006956730,0.15983086951870,0.09945319601320,0.71245854309240,0.17973277222400,0.70017017841750,0.10660658556770,0.60656479847960,0.09933038967690,0.25333815795280,0.10232238261890,0.27695020605750,0.61662279006240,0.49815226370010,0.09041850451490,0.37384185169080,0.09282325847900,0.25216809256970,0.39055805443300,0.50875014376610,0.52667380395540,0.17061422575370,0.25880550848860,0.34875834917030,0.30135221839640,0.16966159632190,0.45847417744780,0.25802038190110,0.18488987045510,0.19216119940690,0.61307403983890,0.16506133364160,0.41805411992440,0.29827190052290,0.51592055343620,0.40988943177920};

Real w120[120] = {0.00148734178590,0.00148890352620,0.00150059443800,0.00150592083130,0.00153188687150,0.00230326344870,0.00236490670420,0.00287511436110,0.00298624887350,0.00303841627370,0.00320924596880,0.00370295984350,0.00374071860350,0.00384525432230,0.00386707786680,0.00391925551780,0.00395732826880,0.00440322517240,0.00459071081730,0.00470236694350,0.00500148438180,0.00523878301560,0.00544221040920,0.00569312489120,0.00591074229890,0.00596879676870,0.00672621902870,0.00683078486240,0.00695312591120,0.00724602706420,0.00727281896130,0.00730089308470,0.00736046667760,0.00741199232550,0.00748922143360,0.00786040672600,0.00786217264230,0.00805063610660,0.00814428604730,0.00814788041520,0.00924441466120,0.00946746351650,0.00971322101370,0.00997535811510,0.01033678036730,0.01122632771660,0.01143091187450,0.01155505674870,0.01355758569570,0.01359849629000,0.01377548138370,0.01379610159420,0.01384088399040,0.01406340199770,0.01409914510090,0.01420041119910,0.01445184245170,0.01502459796390,0.01528178041220,0.01555507241690,0.01645708860000,0.01652757595730,0.01668475544510,0.01674093129850,0.01686746633610,0.01688822301650,0.01720871126910,0.01746810682640,0.01766638996140,0.01829676214750,0.01835768524590,0.01863925695210,0.01897810605900,0.01918479225780,0.01940804420440,0.01947200721930,0.02008550804950,0.02016739093320,0.02217421627610,0.02297024405080,0.02334651173990,0.02348831353380,0.02406820990180,0.02409107929530,0.02456770494810,0.02465363157190,0.02467565300520,0.02497046027100,0.02500265440820,0.02504908694260,0.02509362501250,0.02514820762260,0.02550102904470,0.02565445119790,0.02579747506300,0.02700077539930,0.02744315368440,0.02770724014880,0.02782844153640,0.02872073811050,0.02888268349560,0.02933027297590,0.03189028795570,0.03190836602860,0.03209389603290,0.03216186087800,0.03224241275340,0.03270724464210,0.03299463166950,0.03318280960250,0.03348571626510,0.03354684727920,0.03370490429880,0.03403614627670,0.03424652353230,0.03455288172510,0.03567828757030,0.03646562250160,0.03651727087060,0.03719248110180};
Real L120_1[120] = {0.00828815950330,0.46184220302410,0.00710664412390,0.98476131416990,0.53744478690490,0.00000000000000,0.49141319293610,0.00703459370200,0.95647347142280,0.03701987920450,0.10241245427470,0.59280658115090,0.00509484223710,0.00815620236890,0.04249361075680,0.94955435008440,0.89327874712390,0.00693176129270,0.90358390306650,0.09056657382090,0.00839293327870,0.62612456860710,0.00628015929790,0.82725392573670,0.00620058753530,0.16769003111850,0.71993530695670,0.27497400902370,0.00792575820050,0.00699812207520,0.81252487732630,0.00735369699700,0.72836659354110,0.18006423045650,0.26581024677620,0.00708923645200,0.37740543020430,0.03696496086680,0.92031941098050,0.04254778064310,0.61912783949830,0.37626972091780,0.09561111496900,0.03024734103770,0.87399056917540,0.86041337349580,0.03473078523520,0.10436066083430,0.77976228247540,0.01858651642560,0.03245852866180,0.83712939011570,0.08366020753150,0.07840702425010,0.49292386484580,0.18706375840730,0.48926369670250,0.04019826183720,0.78942592788650,0.16862604564290,0.37509019131740,0.03563628768800,0.58875481648040,0.03733080821820,0.28207699933740,0.68192776033200,0.03749383243820,0.69840792041270,0.26543908940790,0.14298484408000,0.76235540076470,0.09342220227490,0.57590044799230,0.38224273325250,0.04114140816750,0.08024625383790,0.76252298194100,0.15249414451310,0.06221591958330,0.11095390360760,0.45756272120570,0.43228651363740,0.58650028502410,0.08693592508180,0.09295949069360,0.66619321414540,0.47803063622270,0.43722152945770,0.67792245046690,0.24234312556600,0.22889254203050,0.33150650499590,0.34242005266070,0.08626300464750,0.51131889466350,0.15389778410010,0.67799513484720,0.16646004694110,0.09509103188880,0.34360481367120,0.55604170253660,0.14524040295130,0.16196851562380,0.58001648442620,0.24502012232880,0.25576218917940,0.22052399855110,0.49401831112850,0.25315706897980,0.58468911163570,0.16603336022780,0.25054262924610,0.35193368021820,0.35026688354190,0.44008924855120,0.46808554715460,0.17702377639470,0.39009207795010,0.28058477741200,0.33615233474400};
Real L120_2[120] = {0.98482027688690,0.53815779697590,0.00808423613900,0.00700157551340,0.46255521309510,0.48876768801400,0.00000000000000,0.95741580536970,0.03646554494850,0.00709085771660,0.89361255949370,0.00494517056000,0.09966766591890,0.04155611487840,0.94948652603520,0.00817945072920,0.00532243262620,0.90654010204330,0.08947711710770,0.00705253420050,0.66631799311110,0.00921975831530,0.83352074605270,0.16651349393300,0.74246932552290,0.00657177435280,0.00643545349620,0.71852961207190,0.17664113747140,0.27047672540040,0.00822995332100,0.59341678754530,0.26488175537520,0.81158489766820,0.00685535254290,0.37576326597440,0.61485735337570,0.92107923028930,0.04260250821140,0.03726899417940,0.37240557138090,0.00814364220110,0.87710983726010,0.09438589033930,0.03131989908830,0.10490197820460,0.86098564628860,0.03571528810040,0.18723181992650,0.48343976787940,0.77834749160420,0.08040605701560,0.84214148170510,0.08499270891450,0.48928559147100,0.03452108582810,0.01907747550770,0.16911431871090,0.04122067314840,0.78948606405850,0.58953182720130,0.36812562176990,0.03599689625410,0.67907046735330,0.03736399923610,0.28033303457250,0.26340161800140,0.03641546733220,0.69807174361930,0.76122546184530,0.09437412202750,0.14797998368320,0.38213296416980,0.04267163623010,0.57180828744320,0.77022043820420,0.15594205773620,0.08429654213220,0.45381813188730,0.45860140711710,0.47953135602100,0.12305912374720,0.08341197797930,0.67556770133510,0.23265008927270,0.24482940074060,0.06617490448350,0.44421455852440,0.09290965345770,0.08897936551290,0.67800530816720,0.58473815597410,0.51392457227360,0.33409762492340,0.13801547205540,0.67880626195620,0.16633589252690,0.15822145048490,0.56665903325430,0.09789608734570,0.34689178209470,0.35995344910520,0.58101313733300,0.25606746406720,0.58814695521020,0.16522440650470,0.34965074661060,0.25494484484530,0.25433691150170,0.16666039164790,0.25232401917050,0.49590076275280,0.18053803678000,0.43585823298810,0.21205761049410,0.35526815707740,0.46703529222660,0.33231528193000,0.38980411766800,0.27785000443560};

void getWeightsAndAreaCoordinates(Real **w, Real **L1, Real **L2, int n)
{
	switch(n) {
  case 3:
    *w = w3;
    *L1 = L3_1;
    *L2 = L3_2;
    break;
  case 6:
    *w = w6;
    *L1 = L6_1;
    *L2 = L6_2;
    break;
  case 10:
    *w = w10;
    *L1 = L10_1;
    *L2 = L10_2;
    break;
	case 15:
    *w = w15;
    *L1 = L15_1;
    *L2 = L15_2;
    break;
  case 21:
    *w = w21;
    *L1 = L21_1;
    *L2 = L21_2;
    break;
  case 28:
    *w = w28;
    *L1 = L28_1;
    *L2 = L28_2;
    break;
  case 36:
    *w = w36;
    *L1 = L36_1;
    *L2 = L36_2;
    break;
  case 45:
    *w = w45;
    *L1 = L45_1;
    *L2 = L45_2;
    break;
	case 55:
    *w = w55;
    *L1 = L55_1;
    *L2 = L55_2;
    break;
	case 66:
    *w = w66;
    *L1 = L66_1;
    *L2 = L66_2;
    break;
  case 78:
    *w = w78;
    *L1 = L78_1;
    *L2 = L78_2;
    break;
  case 91:
    *w = w91;
    *L1 = L91_1;
    *L2 = L91_2;
    break;
  case 105:
    *w = w105;
    *L1 = L105_1;
    *L2 = L105_2;
    break;
  case 120:
    *w = w105;
    *L1 = L120_1;
    *L2 = L120_2;
    break;
  default:
    abort();
  }
}

// memory leak, but who cares
char *genVectorMultString(Real c, char *v)
{
  char *s = new char[128];
  if(fabs(c) < 1e-6)
    *s = 0;
  else if(fabs(c-1.0) < 1e-6)
    sprintf(s," + %s",v);
  else
    sprintf(s," + %.15g * %s",c,v);
  return s;
}

void genTriangleQuadGauss(int n)
{
  Real *w;
  Real *L1;
  Real *L2;

  getWeightsAndAreaCoordinates(&w,&L1,&L2,n);

  printf("template<class T, class F>\n");
  printf("T quadgauss%d(F f, FunctionArgs *args, Vector3 &v1, Vector3 &v2, Vector3 *v0in, void *quadargs, Real reltol, Real abstol)\n", n);
  printf("{\n");
  printf("\tVector3 v0;\n");
  printf("\tVector3 v(0.0,0.0,0.0);\n");
  printf("\tif(v0in == NULL) v0 = v; else v0 = *v0in;\n");
  printf("\tReal v0x = v0.x;\n");
  printf("\tReal v0y = v0.y;\n");
  printf("\tReal v0z = v0.z;\n");
  printf("\tReal v1x = v1.x;\n");
  printf("\tReal v1y = v1.y;\n");
  printf("\tReal v1z = v1.z;\n");
  printf("\tReal v2x = v2.x;\n");
  printf("\tReal v2y = v2.y;\n");
  printf("\tReal v2z = v2.z;\n");
  Real c1;
  Real c2;
  c1 = 1.0/3.0*(1.0 - L1[0] - L2[0] + 2.0 * (1.0 - L1[0] - L2[0]));
  c2 = 1.0/3.0*(1.0 - L1[0] + 2.0 * L2[0] - (1.0 - L1[0] - L2[0]));
  if(fabs(c1)<1e-6 || fabs(c2)<1e-6 || fabs(1-c1-c2)<1e-6) {
    printf("\t//WARNING: Evaluating on boundary\n");
  }
  printf("\tT q;\n");
  printf("\tT r;\n");
  printf("\tv.x = v0x%s%s;\n", genVectorMultString(c1,"v1x"), genVectorMultString(c2,"v2x"));
  printf("\tv.y = v0y%s%s;\n", genVectorMultString(c1,"v1y"), genVectorMultString(c2,"v2y"));
  printf("\tv.z = v0z%s%s;\n", genVectorMultString(c1,"v1z"), genVectorMultString(c2,"v2z"));
  printf("\tf(&v,&q,args);\n");
  printf("\tq *= %.15g;\n", 0.25*w[0]);

  for(int i=1;i<n;i++) {
    c1 = 1.0/3.0*(1.0 - L1[i] - L2[i] + 2.0 * (1.0 - L1[i] - L2[i]));
    c2 = 1.0/3.0*(1.0 - L1[i] + 2.0 * L2[i] - (1.0 - L1[i] - L2[i]));
    if(fabs(c1)<1e-6 || fabs(c2)<1e-6 || fabs(1-c1-c2)<1e-6) {
      printf("\t//WARNING: Evaluating on boundary\n");
    }
    printf("\tv.x = v0x%s%s;\n", genVectorMultString(c1,"v1x"), genVectorMultString(c2,"v2x"));
    printf("\tv.y = v0y%s%s;\n", genVectorMultString(c1,"v1y"), genVectorMultString(c2,"v2y"));
    printf("\tv.z = v0z%s%s;\n", genVectorMultString(c1,"v1z"), genVectorMultString(c2,"v2z"));
    printf("\tf(&v,&r,args);\n");
    printf("\tr *= %.15g;\n", 0.25*w[i]);
    printf("\tq += r;\n");
  }

  printf("\treturn q;\n");
  printf("}\n\n");

}

int main(int argc, char **argv) {
  genTriangleQuadGauss(atoi(argv[1]));
}
